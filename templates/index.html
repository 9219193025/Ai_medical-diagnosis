<!DOCTYPE html>
<html>
<head>
    <title>AI Medical Diagnosis</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<div class="container">
    <h1>AI Medical Diagnosis</h1>

    <form id="diagnosisForm">
        <select id="symptoms" multiple>
            {% for s in symptom_columns %}
            <option value="{{ s }}">{{ s }}</option>
            {% endfor %}
        </select>
        <button type="submit">Run Diagnosis</button>
    </form>

    <div id="result"></div>
</div>

<script>
document.getElementById("diagnosisForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const symptoms = Array.from(
        document.getElementById("symptoms").selectedOptions
    ).map(o => o.value);

    const token = localStorage.getItem("token");
    if (!token) {
        window.location.href = "/login";
        return;
    }

    const res = await fetch("/predict", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "Authorization": token
        },
        body: JSON.stringify({ symptoms })
    });

    const data = await res.json();
    if (data.error) {
        alert(data.error);
        return;
    }

    document.getElementById("result").innerHTML =
        `<h3>Disease: ${data.disease}</h3>`;
});
</script>

</body>
</html>
